<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>The Wind in the Willows - Story</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 1em;
    background: #f9f9f9;
  }
  #story {
    font-size: 2em;
    font-weight: bold;
    line-height: 1.4;
    max-width: 600px;
    margin: 0 auto;
    position: relative;
  }
  #story span {
    text-decoration: underline;
    cursor: pointer;
    padding: 0 0.1em;
    border-radius: 2px;
  }
  #story span.highlighted {
    background-color: #add8e6;
  }
  #popup {
    position: absolute;
    background: white;
    border: 2px solid #007acc;
    border-radius: 8px;
    padding: 1em;
    font-weight: bold;
    font-size: 1.5em;
    max-width: calc(100% - 3em);
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    z-index: 1000;
    display: none;
  }
  #popup .close-btn {
    position: absolute;
    top: 0.2em;
    right: 0.5em;
    font-size: 1.5em;
    font-weight: bold;
    color: #007acc;
    cursor: pointer;
    user-select: none;
  }
  #popup .word {
    text-align: center;
    margin-bottom: 0.5em;
  }
  #popup .definition {
    margin-bottom: 0.7em;
  }
  #popup ul.examples {
    list-style: none;
    padding-left: 1em;
  }
  #popup ul.examples li {
    margin-bottom: 0.3em;
  }
</style>
</head>
<body>
<div id="story">
  <span data-word="Mole">Mole</span> 
  <span data-word="was">was</span> 
  <span data-word="cleaning">cleaning</span> 
  <span data-word="his">his</span> 
  <span data-word="little">little</span> 
  <span data-word="home">home</span> 
  <span data-word="when">when</span> 
  <span data-word="he">he</span> 
  <span data-word="suddenly">suddenly</span> 
  <span data-word="felt">felt</span> 
  <span data-word="tired">tired</span> 
  <span data-word="of">of</span> 
  <span data-word="it">it</span> 
  <span data-word="all">all</span>. 
  <span data-word="He">He</span> 
  <span data-word="had">had</span> 
  <span data-word="been">been</span> 
  <span data-word="working">working</span> 
  <span data-word="hard">hard</span> 
  <span data-word="all">all</span> 
  <span data-word="morning">morning</span> 
  <span data-word="and">and</span> 
  <span data-word="now">now</span> 
  <span data-word="he">he</span> 
  <span data-word="wanted">wanted</span> 
  <span data-word="to">to</span> 
  <span data-word="see">see</span> 
  <span data-word="the">the</span> 
  <span data-word="world">world</span> 
  <span data-word="outside">outside</span>. 
  <span data-word="He">He</span> 
  <span data-word="put">put</span> 
  <span data-word="down">down</span> 
  <span data-word="his">his</span> 
  <span data-word="cleaning">cleaning</span> 
  <span data-word="tools">tools</span> 
  <span data-word="and">and</span> 
  <span data-word="made">made</span> 
  <span data-word="his">his</span> 
  <span data-word="way">way</span> 
  <span data-word="up">up</span> 
  <span data-word="the">the</span> 
  <span data-word="tunnel">tunnel</span> 
  <span data-word="to">to</span> 
  <span data-word="the">the</span> 
  <span data-word="outside">outside</span>. 
  <span data-word="The">The</span> 
  <span data-word="sunshine">sunshine</span> 
  <span data-word="was">was</span> 
  <span data-word="bright">bright</span> 
  <span data-word="and">and</span> 
  <span data-word="warm">warm</span> 
  <span data-word="on">on</span> 
  <span data-word="his">his</span> 
  <span data-word="fur">fur</span>. 
  <span data-word="Mole">Mole</span> 
  <span data-word="had">had</span> 
  <span data-word="never">never</span> 
  <span data-word="seen">seen</span> 
  <span data-word="so">so</span> 
  <span data-word="much">much</span> 
  <span data-word="green">green</span> 
  <span data-word="grass">grass</span> 
  <span data-word="and">and</span> 
  <span data-word="blue">blue</span> 
  <span data-word="sky">sky</span> 
  <span data-word="before">before</span>. 
  <span data-word="He">He</span> 
  <span data-word="walked">walked</span> 
  <span data-word="and">and</span> 
  <span data-word="walked">walked</span> 
  <span data-word="until">until</span> 
  <span data-word="he">he</span> 
  <span data-word="came">came</span> 
  <span data-word="to">to</span> 
  <span data-word="the">the</span> 
  <span data-word="river">river</span>, 
  <span data-word="something">something</span> 
  <span data-word="he">he</span> 
  <span data-word="had">had</span> 
  <span data-word="never">never</span> 
  <span data-word="seen">seen</span> 
  <span data-word="in">in</span> 
  <span data-word="his">his</span> 
  <span data-word="life">life</span>. 
  <span data-word="The">The</span> 
  <span data-word="water">water</span> 
  <span data-word="sparkled">sparkled</span> 
  <span data-word="in">in</span> 
  <span data-word="the">the</span> 
  <span data-word="sun">sun</span> 
  <span data-word="as">as</span> 
  <span data-word="it">it</span> 
  <span data-word="flowed">flowed</span> 
  <span data-word="past">past</span>. 
  <span data-word="Mole">Mole</span> 
  <span data-word="was">was</span> 
  <span data-word="so">so</span> 
  <span data-word="happy">happy</span> 
  <span data-word="that">that</span> 
  <span data-word="he">he</span> 
  <span data-word="sat">sat</span> 
  <span data-word="down">down</span> 
  <span data-word="on">on</span> 
  <span data-word="the">the</span> 
  <span data-word="bank">bank</span> 
  <span data-word="to">to</span> 
  <span data-word="watch">watch</span> 
  <span data-word="the">the</span> 
  <span data-word="water">water</span> 
  <span data-word="and">and</span> 
  <span data-word="the">the</span> 
  <span data-word="animals">animals</span> 
  <span data-word="that">that</span> 
  <span data-word="lived">lived</span> 
  <span data-word="there">there</span>.
</div>

<div id="popup" role="dialog" aria-modal="true" aria-labelledby="popup-word" aria-describedby="popup-def">
  <div class="close-btn" tabindex="0" aria-label="Close definition popup">Ã—</div>
  <div class="word" id="popup-word"></div>
  <div class="definition" id="popup-def"></div>
  <ul class="examples" id="popup-examples"></ul>
</div>

<script>
  (() => {
    const story = document.getElementById('story');
    const popup = document.getElementById('popup');
    const popupWord = document.getElementById('popup-word');
    const popupDef = document.getElementById('popup-def');
    const popupExamples = document.getElementById('popup-examples');
    const closeBtn = popup.querySelector('.close-btn');

    // Dictionary with definitions and examples for every word/idiom in the story.
    // Definitions are simple and use 3rd grade level words.
    // Examples use the definition meaning in simple sentences.
    const dictionary = {
      "Mole": {
        definition: "A small animal that lives underground and likes to dig tunnels.",
        examples: [
          "The mole digs tunnels under the ground.",
          "Moles have soft fur and small eyes.",
          "A mole lives in a dark, cozy home.",
          "We saw a mole near the garden.",
          "The mole likes to eat worms.",
          "Mole is the name of the animal in the story."
        ]
      },
      "was": {
        definition: "Used to say something happened in the past.",
        examples: [
          "She was happy yesterday.",
          "The dog was sleeping.",
          "It was cold last night.",
          "He was at school this morning.",
          "The sun was shining.",
          "I was tired after playing."
        ]
      },
      "cleaning": {
        definition: "Making something free from dirt or mess.",
        examples: [
          "She is cleaning her room.",
          "We are cleaning the table.",
          "He is cleaning his shoes.",
          "They are cleaning the house.",
          "Mom is cleaning the windows.",
          "I am cleaning my desk."
        ]
      },
      "his": {
        definition: "Belonging to a boy or man.",
        examples: [
          "This is his book.",
          "He lost his hat.",
          "His dog is big.",
          "The boy took his ball.",
          "His shoes are new.",
          "I like his coat."
        ]
      },
      "little": {
        definition: "Small in size or amount.",
        examples: [
          "She has a little cat.",
          "The box is little.",
          "He gave me a little toy.",
          "There is a little bird outside.",
          "The little boy is happy.",
          "I saw a little flower."
        ]
      },
      "home": {
        definition: "The place where someone lives.",
        examples: [
          "My home is warm.",
          "She went back home.",
          "The house is their home.",
          "We like our home.",
          "He stayed at home.",
          "Home is where family is."
        ]
      },
      "when": {
        definition: "At the time that something happens.",
        examples: [
          "I eat when I am hungry.",
          "She smiled when she saw me.",
          "Call me when you arrive.",
          "He runs fast when he plays.",
          "We laugh when we are happy.",
          "The lights go off when it is dark."
        ]
      },
      "he": {
        definition: "Used to talk about a boy or man.",
        examples: [
          "He is my friend.",
          "He likes to run.",
          "He has a red hat.",
          "He is very kind.",
          "He plays with toys.",
          "He reads a book."
        ]
      },
      "suddenly": {
        definition: "Happening very quickly and without warning.",
        examples: [
          "Suddenly, the dog barked.",
          "The rain started suddenly.",
          "She suddenly jumped up.",
          "Suddenly, the lights went out.",
          "He suddenly ran away.",
          "The car stopped suddenly."
        ]
      },
      "felt": {
        definition: "To have a feeling or sense something.",
        examples: [
          "I felt happy today.",
          "She felt cold outside.",
          "He felt tired after running.",
          "They felt scared in the dark.",
          "We felt warm by the fire.",
          "The baby felt sleepy."
        ]
      },
      "tired": {
        definition: "Feeling like you need to rest or sleep.",
        examples: [
          "I am tired after playing.",
          "She felt tired at night.",
          "He was tired from walking.",
          "They are tired after school.",
          "The dog looks tired.",
          "We get tired when we run."
        ]
      },
      "of": {
        definition: "Used to show what something belongs to or is about.",
        examples: [
          "A cup of water.",
          "The color of the sky.",
          "A piece of cake.",
          "The sound of birds.",
          "A box of toys.",
          "The smell of flowers."
        ]
      },
      "it": {
        definition: "Used to talk about a thing or animal already known.",
        examples: [
          "It is raining.",
          "I like it.",
          "The dog is big. It is friendly.",
          "It is cold outside.",
          "Turn it off.",
          "It is my toy."
        ]
      },
      "all": {
        definition: "Everything or every one.",
        examples: [
          "All the kids are here.",
          "I ate all the food.",
          "She read all the books.",
          "All the birds are singing.",
          "We played all day.",
          "All the toys are clean."
        ]
      },
      "had": {
        definition: "Used to say someone owned or did something in the past.",
        examples: [
          "She had a bike.",
          "He had a big dog.",
          "They had fun yesterday.",
          "I had lunch at noon.",
          "We had a party.",
          "The cat had a nap."
        ]
      },
      "been": {
        definition: "Used to say something happened before now.",
        examples: [
          "I have been to the park.",
          "She has been busy.",
          "They have been friends.",
          "He has been sick.",
          "We have been waiting.",
          "The dog has been outside."
        ]
      },
      "working": {
        definition: "Doing a job or task.",
        examples: [
          "She is working hard.",
          "He is working on his homework.",
          "They are working together.",
          "I am working now.",
          "We are working in the garden.",
          "The man is working."
        ]
      },
      "hard": {
        definition: "With a lot of effort or energy.",
        examples: [
          "She works hard every day.",
          "He tried hard to win.",
          "They worked hard on the project.",
          "I study hard for tests.",
          "The dog works hard to learn.",
          "We play hard outside."
        ]
      },
      "morning": {
        definition: "The early part of the day before noon.",
        examples: [
          "I eat breakfast in the morning.",
          "The sun rises in the morning.",
          "She goes to school in the morning.",
          "We play outside in the morning.",
          "The birds sing in the morning.",
          "He wakes up in the morning."
        ]
      },
      "and": {
        definition: "Used to join words or ideas together.",
        examples: [
          "I like apples and bananas.",
          "She runs and jumps.",
          "We read and write.",
          "He sings and dances.",
          "They play and laugh.",
          "The sun is bright and warm."
        ]
      },
      "now": {
        definition: "At this time or moment.",
        examples: [
          "I am eating now.",
          "She is here now.",
          "We go outside now.",
          "He is sleeping now.",
          "The rain stops now.",
          "Look at me now."
        ]
      },
      "wanted": {
        definition: "To wish or hope for something.",
        examples: [
          "I wanted a toy.",
          "She wanted to play.",
          "He wanted some water.",
          "They wanted to go home.",
          "We wanted a story.",
          "The cat wanted food."
        ]
      },
      "to": {
        definition: "Used to show direction, place, or purpose.",
        examples: [
          "Go to school.",
          "I like to read.",
          "She walks to the park.",
          "We want to play.",
          "He runs to the door.",
          "They talk to friends."
        ]
      },
      "see": {
        definition: "To use your eyes to look at something.",
        examples: [
          "I see a bird.",
          "She sees the sun.",
          "He sees a big tree.",
          "We see the stars.",
          "They see a rainbow.",
          "The dog sees a ball."
        ]
      },
      "the": {
        definition: "Used before a noun to talk about something specific.",
        examples: [
          "The cat is black.",
          "I like the book.",
          "She has the ball.",
          "We see the moon.",
          "He eats the apple.",
          "They go to the park."
        ]
      },
      "world": {
        definition: "The earth and everything on it.",
        examples: [
          "We live in the world.",
          "The world is big.",
          "People live all over the world.",
          "The world has many animals.",
          "The world is full of trees.",
          "I want to see the world."
        ]
      },
      "outside": {
        definition: "Not inside a building or room.",
        examples: [
          "We play outside.",
          "The dog is outside.",
          "She looks outside the window.",
          "It is warm outside.",
          "They run outside.",
          "He likes to be outside."
        ]
      },
      "put": {
        definition: "To move something to a place.",
        examples: [
          "Put the book on the table.",
          "She put on her coat.",
          "He put the toy away.",
          "We put the food in the box.",
          "They put the chair here.",
          "I put my hat down."
        ]
      },
      "down": {
        definition: "From a higher place to a lower place.",
        examples: [
          "The ball rolled down the hill.",
          "She sat down on the chair.",
          "He looked down at the floor.",
          "The bird flew down.",
          "We went down the stairs.",
          "The rain came down."
        ]
      },
      "tools": {
        definition: "Things used to do work or fix things.",
        examples: [
          "He uses tools to build.",
          "The hammer is a tool.",
          "She has many tools.",
          "We need tools to fix the bike.",
          "The toolbox has tools inside.",
          "They use tools to clean."
        ]
      },
      "made": {
        definition: "To create or do something.",
        examples: [
          "She made a cake.",
          "He made a drawing.",
          "They made a sandcastle.",
          "I made a card.",
          "We made a boat.",
          "The dog made a mess."
        ]
      },
      "way": {
        definition: "A path or road to go somewhere.",
        examples: [
          "This is the way home.",
          "She found a new way.",
          "He walked the way to school.",
          "We lost our way.",
          "The way is long.",
          "They showed me the way."
        ]
      },
      "up": {
        definition: "From a lower place to a higher place.",
        examples: [
          "He climbed up the tree.",
          "She looked up at the sky.",
          "The sun went up.",
          "We ran up the hill.",
          "The balloon went up.",
          "They stood up."
        ]
      },
      "tunnel": {
        definition: "A long, narrow passage underground or through a hill.",
        examples: [
          "The train goes through a tunnel.",
          "We walked in the dark tunnel.",
          "The mole lives in a tunnel.",
          "The tunnel is very long.",
          "Cars drive through the tunnel.",
          "The tunnel is cool inside."
        ]
      },
      "sunshine": {
        definition: "The light and heat that comes from the sun.",
        examples: [
          "The sunshine is warm.",
          "We play in the sunshine.",
          "Sunshine makes flowers grow.",
          "I like the bright sunshine.",
          "The sunshine feels nice.",
          "The sunshine is yellow."
        ]
      },
      "bright": {
        definition: "Giving a lot of light or shining strongly.",
        examples: [
          "The sun is bright today.",
          "She has bright eyes.",
          "The light is very bright.",
          "The stars are bright at night.",
          "His shirt is bright red.",
          "The room is bright and clean."
        ]
      },
      "warm": {
        definition: "Having a comfortable, not hot or cold, temperature.",
        examples: [
          "The blanket is warm.",
          "It is warm outside.",
          "She feels warm by the fire.",
          "The sun gives warm light.",
          "The soup is warm.",
          "We wear warm clothes in winter."
        ]
      },
      "fur": {
        definition: "The soft hair that covers animals.",
        examples: [
          "The cat has soft fur.",
          "The bear's fur is thick.",
          "Mole has black fur.",
          "The dog shakes its fur.",
          "The rabbit's fur is white.",
          "Fur keeps animals warm."
        ]
      },
      "never": {
        definition: "Not at any time.",
        examples: [
          "I never eat candy before dinner.",
          "She never forgets her keys.",
          "He never goes to bed late.",
          "They never swim in cold water.",
          "We never lie to friends.",
          "The mole had never seen a river."
        ]
      },
      "seen": {
        definition: "To have looked at something before.",
        examples: [
          "I have seen that movie.",
          "She has seen a rainbow.",
          "He has seen a big bird.",
          "We have seen the stars.",
          "They have seen the ocean.",
          "The mole had never seen a river."
        ]
      },
      "so": {
        definition: "To a great degree or very much.",
        examples: [
          "I am so happy.",
          "She runs so fast.",
          "It is so cold today.",
          "The cake is so sweet.",
          "He is so tall.",
          "The water sparkled so brightly."
        ]
      },
      "much": {
        definition: "A large amount or number.",
        examples: [
          "I have much homework.",
          "She eats so much food.",
          "He has much fun at school.",
          "We see much green grass.",
          "They gave me much help.",
          "There is much water in the river."
        ]
      },
      "green": {
        definition: "The color of grass and leaves.",
        examples: [
          "The grass is green.",
          "She wore a green dress.",
          "The tree has green leaves.",
          "Green means go.",
          "The frog is green.",
          "The meadow is green and bright."
        ]
      },
      "grass": {
        definition: "The green plants that grow on the ground outside.",
        examples: [
          "The dog runs on the grass.",
          "We sit on the soft grass.",
          "The grass is wet with dew.",
          "The meadow is full of grass.",
          "She picks flowers from the grass.",
          "The grass is green and fresh."
        ]
      },
      "blue": {
        definition: "The color of the sky or the sea on a clear day.",
        examples: [
          "The sky is blue.",
          "She has blue eyes.",
          "The water looks blue.",
          "He wears a blue shirt.",
          "The bird has blue feathers.",
          "The river is blue and clear."
        ]
      },
      "sky": {
        definition: "The space above the earth where clouds and the sun are.",
        examples: [
          "The sky is bright today.",
          "Birds fly in the sky.",
          "The stars shine in the sky.",
          "The sky is blue and clear.",
          "Clouds move across the sky.",
          "The sun sets in the sky."
        ]
      },
      "before": {
        definition: "Earlier than now or earlier than something else.",
        examples: [
          "I ate breakfast before school.",
          "She saw the movie before lunch.",
          "He was here before you.",
          "We met before the party.",
          "They played before dinner.",
          "Mole had never seen a river before."
        ]
      },
      "walked": {
        definition: "Moved by putting one foot in front of the other.",
        examples: [
          "She walked to school.",
          "He walked in the park.",
          "We walked home together.",
          "They walked slowly.",
          "The dog walked with me.",
          "Mole walked until he found the river."
        ]
      },
      "until": {
        definition: "Up to the time that something happens.",
        examples: [
          "Wait until I come.",
          "She stayed until dark.",
          "He worked until noon.",
          "We played until it rained.",
          "They talked until bedtime.",
          "Mole walked until he came to the river."
        ]
      },
      "came": {
        definition: "Moved toward a place or person.",
        examples: [
          "She came to the door.",
          "He came home late.",
          "We came to the park.",
          "They came to visit.",
          "The dog came to me.",
          "Mole came to the river."
        ]
      },
      "river": {
        definition: "A large, flowing body of water.",
        examples: [
          "The river is wide.",
          "Fish live in the river.",
          "We saw boats on the river.",
          "The river flows to the sea.",
          "She likes to watch the river.",
          "Mole saw the river for the first time."
        ]
      },
      "something": {
        definition: "A thing that is not named or known.",
        examples: [
          "I want something to eat.",
          "She found something on the ground.",
          "He said something funny.",
          "We saw something move.",
          "They heard something outside.",
          "Mole saw something he never saw before."
        ]
      },
      "life": {
        definition: "The time when someone or something is alive.",
        examples: [
          "We live a happy life.",
          "She loves life outside.",
          "The tree has a long life.",
          "Animals have different lives.",
          "He enjoys life every day.",
          "Mole had never seen a river in his life."
        ]
      },
      "water": {
        definition: "The clear liquid that people and animals drink and that fills rivers and lakes.",
        examples: [
          "We drink water every day.",
          "The river has clean water.",
          "Fish live in the water.",
          "She splashed water on her face.",
          "The water is cold.",
          "The water sparkled in the sun."
        ]
      },
      "sparkled": {
        definition: "Shined with many small bright points of light.",
        examples: [
          "The stars sparkled at night.",
          "The water sparkled in the sun.",
          "Her eyes sparkled with joy.",
          "The snow sparkled in the light.",
          "The jewels sparkled on the ring.",
          "The lake sparkled under the sun."
        ]
      },
      "in": {
        definition: "Inside or within a place or thing.",
        examples: [
          "The book is in the bag.",
          "She is in the room.",
          "Fish swim in the water.",
          "We live in a house.",
          "The cat is in the box.",
          "The water sparkled in the sun."
        ]
      },
      "as": {
        definition: "Used to show how something happens or to compare things.",
        examples: [
          "She sings as beautifully as a bird.",
          "He runs as fast as a car.",
          "The water sparkled as it flowed.",
          "I work as hard as you.",
          "It is as bright as the sun.",
          "The dog is as big as a cat."
        ]
      },
      "flowed": {
        definition: "Moved like a liquid from one place to another.",
        examples: [
          "The river flowed slowly.",
          "Water flowed from the tap.",
          "The juice flowed into the glass.",
          "The wind flowed through the trees.",
          "The paint flowed on the wall.",
          "The water flowed past the bank."
        ]
      },
      "past": {
        definition: "Going by or beyond a place.",
        examples: [
          "We walked past the school.",
          "The car drove past the house.",
          "She ran past the park.",
          "The river flowed past the trees.",
          "He looked past the window.",
          "The dog ran past me."
        ]
      },
      "happy": {
        definition: "Feeling good and smiling because of something nice.",
        examples: [
          "I am happy today.",
          "She is happy with her toy.",
          "They are happy to play.",
          "He felt happy after the game.",
          "The children are happy at school.",
          "Mole was happy to see the river."
        ]
      },
      "that": {
        definition: "Used to show a thing or idea already mentioned.",
        examples: [
          "I like that book.",
          "She said that it was fun.",
          "He knows that story.",
          "We saw that movie.",
          "They like that game.",
          "Mole was so happy that he sat down."
        ]
      },
      "sat": {
        definition: "To rest with the body on a chair or the ground.",
        examples: [
          "She sat on the chair.",
          "He sat by the window.",
          "We sat on the grass.",
          "The dog sat next to me.",
          "They sat down to eat.",
          "Mole sat on the bank."
        ]
      },
      "on": {
        definition: "Touching or supported by a surface.",
        examples: [
          "The book is on the table.",
          "She sat on the floor.",
          "The cat is on the roof.",
          "He put his hand on my shoulder.",
          "We walked on the path.",
          "Mole sat on the bank."
        ]
      },
      "bank": {
        definition: "The side of a river or lake.",
        examples: [
          "We sat on the river bank.",
          "The flowers grow on the bank.",
          "The boat is near the bank.",
          "Fish swim close to the bank.",
          "He walked along the bank.",
          "Mole watched the water from the bank."
        ]
      },
      "watch": {
        definition: "To look at something carefully.",
        examples: [
          "I watch TV every day.",
          "She watches the birds.",
          "He watches the game.",
          "We watch the sunset.",
          "They watch the animals.",
          "Mole watched the water and animals."
        ]
      },
      "animals": {
        definition: "Living creatures that are not people or plants.",
        examples: [
          "Dogs and cats are animals.",
          "She likes wild animals.",
          "The farm has many animals.",
          "Animals live in the forest.",
          "We see animals at the zoo.",
          "Mole saw animals by the river."
        ]
      },
      "lived": {
        definition: "To have a home or place where someone stays.",
        examples: [
          "She lived in a big house.",
          "He lived in the city.",
          "They lived by the river.",
          "The bird lived in the tree.",
          "We lived there last year.",
          "Animals lived near the water."
        ]
      },
      "there": {
        definition: "In or at that place.",
        examples: [
          "The book is over there.",
          "She is standing there.",
          "We went there yesterday.",
          "He lives there now.",
          "The animals are there by the river.",
          "Mole sat down there."
        ]
      }
    };

    let currentHighlighted = null;

    function closePopup() {
      if (currentHighlighted) {
        currentHighlighted.classList.remove('highlighted');
        currentHighlighted = null;
      }
      popup.style.display = 'none';
    }

    function positionPopup(target) {
      const storyRect = story.getBoundingClientRect();
      const targetRect = target.getBoundingClientRect();
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;

      // Calculate top: about 2em below the word's bottom inside story block
      const lineHeight = parseFloat(getComputedStyle(story).fontSize) * 1.4;
      const top = targetRect.bottom - storyRect.top + lineHeight * 2 + scrollTop;

      // Horizontal center aligned with story block, with margin 2-3 letters from edges
      const storyWidth = storyRect.width;
      const approxLetterWidth = parseFloat(getComputedStyle(story).fontSize) * 0.6;
      const popupWidth = storyWidth - approxLetterWidth * 5;

      popup.style.width = popupWidth + 'px';
      popup.style.left = (storyRect.left + scrollLeft + approxLetterWidth * 2) + 'px';
      popup.style.top = top + 'px';
    }

    function showPopup(wordSpan) {
      const wordKey = wordSpan.dataset.word;
      const entry = dictionary[wordKey];
      if (!entry) return;

      if (currentHighlighted) {
        currentHighlighted.classList.remove('highlighted');
      }
      currentHighlighted = wordSpan;
      wordSpan.classList.add('highlighted');

      popupWord.textContent = wordKey;
      popupDef.textContent = entry.definition;
      popupExamples.innerHTML = '';
      entry.examples.forEach(example => {
        const li = document.createElement('li');
        li.textContent = example;
        popupExamples.appendChild(li);
      });

      popup.style.display = 'block';
      positionPopup(wordSpan);
      closeBtn.focus();
    }

    story.addEventListener('click', (e) => {
      if (e.target.tagName === 'SPAN' && e.target.dataset.word) {
        if (currentHighlighted === e.target) {
          closePopup();
        } else {
          showPopup(e.target);
        }
      }
    });

    closeBtn.addEventListener('click', () => {
      closePopup();
    });

    closeBtn.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ' || e.key === 'Spacebar') {
        e.preventDefault();
        closePopup();
      }
    });

    window.addEventListener('resize', () => {
      if (currentHighlighted) {
        positionPopup(currentHighlighted);
      }
    });

    window.addEventListener('scroll', () => {
      if (currentHighlighted) {
        positionPopup(currentHighlighted);
      }
    });
  })();
</script>
</body>
</html>
